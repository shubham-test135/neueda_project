<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analytics & Benchmarking - FinBuddy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../css/dashboard.css" />
    <link rel="stylesheet" href="../css/components.css" />
    <link rel="stylesheet" href="../css/analytics-wishlist.css" />
  </head>
  <body>
    <!-- Sidebar Navigation -->
    <div id="sidebar-container"></div>

    <!-- Main Container -->
    <div class="main-container">
      <!-- Top Navigation Bar -->
      <div id="navbar-container"></div>

      <!-- Main Content Area -->
      <main class="main-content">
        <div class="content-wrapper">
          <!-- Page Header -->
          <header class="page-header">
            <div>
              <h1 class="page-title">
                <i class="fas fa-chart-bar"></i>
                Analytics & Benchmarking
              </h1>
              <p class="page-subtitle">
                Deep insights into your portfolio performance with market
                benchmarks
              </p>
            </div>
            <div class="header-actions">
              <select id="timeRangeSelect" class="select-input">
                <option value="1M">Last Month</option>
                <option value="3M">Last 3 Months</option>
                <option value="6M" selected>Last 6 Months</option>
                <option value="1Y">Last Year</option>
                <option value="ALL">All Time</option>
              </select>
            </div>
          </header>

          <!-- Performance Overview -->
          <section class="section-card" aria-labelledby="performance-heading">
            <div class="section-header">
              <div class="section-title">
                <i class="fas fa-tachometer-alt"></i>
                <h2 id="performance-heading">Performance Overview</h2>
              </div>
            </div>
            <div class="analytics-grid">
              <article class="metric-card">
                <div class="metric-icon gradient-blue">
                  <i class="fas fa-chart-line"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-label">Total Returns</h3>
                  <p class="metric-value" id="totalReturns">$0.00</p>
                  <span class="metric-change positive" id="returnsChange">
                    <i class="fas fa-arrow-up"></i> 0%
                  </span>
                </div>
              </article>

              <article class="metric-card">
                <div class="metric-icon gradient-purple">
                  <i class="fas fa-chart-area"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-label">Volatility</h3>
                  <p class="metric-value" id="volatilityValue">0.0%</p>
                  <span class="metric-description">Standard Deviation</span>
                </div>
              </article>

              <article class="metric-card">
                <div class="metric-icon gradient-orange">
                  <i class="fas fa-balance-scale"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-label">Sharpe Ratio</h3>
                  <p class="metric-value" id="sharpeRatio">0.00</p>
                  <span class="metric-description">Risk-Adjusted Return</span>
                </div>
              </article>
            </div>
          </section>

          <!-- Add Benchmark Form -->
          <div class="add-asset-form" id="addBenchmarkFormSection" style="display: none">
            <div class="form-header">
              <h3><i class="fas fa="plus"></i> Add Benchmark</h3>
              <button class="close-form-btn" id="closeBenchmarkFormBtn">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <form id="addBenchmarkFormNew">
              <div class="form-grid">
                <div class="form-group">
                  <label><i class="fas fa-code"></i> Benchmark Symbol</label>
                  <input
                    type="text"
                    id="benchmarkSymbolNew"
                    class="form-input"
                    placeholder="e.g., ^GSPC, ^NSEI, ^DJI"
                    required
                  />
                  <small>Use ^ for indices (e.g., ^GSPC for S&P 500, ^NSEI for NIFTY 50)</small>
                </div>
                <div class="form-group">
                  <label><i class="fas fa-tag"></i> Benchmark Name</label>
                  <input
                    type="text"
                    id="benchmarkNameNew"
                    class="form-input"
                    placeholder="e.g., S&P 500, NIFTY 50"
                    required
                  />
                </div>
                <div class="form-group">
                  <label><i class="fas fa-layer-group"></i> Index Type</label>
                  <select id="benchmarkTypeNew" class="form-select" required>
                    <option value="">Select Type</option>
                    <option value="EQUITY">Equity Index</option>
                    <option value="BOND">Bond Index</option>
                    <option value="COMMODITY">Commodity Index</option>
                    <option value="MIXED">Mixed Index</option>
                    <option value="OTHER">Other</option>
                  </select>
                </div>
                <div class="form-group">
                  <label><i class="fas fa-align-left"></i> Description (Optional)</label>
                  <textarea
                    id="benchmarkDescriptionNew"
                    class="form-input"
                    rows="3"
                    placeholder="Add notes about this benchmark..."
                  ></textarea>
                </div>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-plus"></i> Add Benchmark
                </button>
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="cancelBenchmarkFormBtn"
                >
                  <i class="fas fa-times"></i> Cancel
                </button>
              </div>
            </form>
          </div>

          <!-- Benchmark Comparison -->
          <section class="section-card" aria-labelledby="benchmark-heading">
            <div class="section-header">
              <div class="section-title">
                <i class="fas fa-trophy"></i>
                <h2 id="benchmark-heading">Benchmark Comparison</h2>
              </div>
              <div class="header-actions">
                <button class="btn-secondary" id="addBenchmarkBtn">
                  <i class="fas fa-plus"></i> Add Benchmark
                </button>
              </div>
            </div>
            <div class="benchmark-comparison-grid">
              <div class="comparison-chart">
                <canvas
                  id="performanceChart"
                  aria-label="Portfolio vs Benchmark Performance Chart"
                ></canvas>
              </div>
              <aside class="benchmark-list">
                <h3 class="list-title">Active Benchmarks</h3>
                <ul class="benchmarks" id="benchmarksList">
                  <li class="benchmark-item">
                    <div class="benchmark-info">
                      <span class="benchmark-name">S&P 500</span>
                      <span class="benchmark-ticker">^GSPC</span>
                    </div>
                    <div class="benchmark-performance">
                      <span class="performance-value positive">+12.5%</span>
                      <button class="btn-icon" aria-label="Remove benchmark">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </li>
                  <li class="benchmark-item">
                    <div class="benchmark-info">
                      <span class="benchmark-name">NASDAQ</span>
                      <span class="benchmark-ticker">^IXIC</span>
                    </div>
                    <div class="benchmark-performance">
                      <span class="performance-value positive">+18.3%</span>
                      <button class="btn-icon" aria-label="Remove benchmark">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </li>
                  <li class="benchmark-item">
                    <div class="benchmark-info">
                      <span class="benchmark-name">NIFTY 50</span>
                      <span class="benchmark-ticker">^NSEI</span>
                    </div>
                    <div class="benchmark-performance">
                      <span class="performance-value positive">+15.7%</span>
                      <button class="btn-icon" aria-label="Remove benchmark">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </li>
                </ul>
              </aside>
            </div>
          </section>

          <!-- Asset Allocation Analysis -->
          <section class="section-card" aria-labelledby="allocation-heading">
            <div class="section-header">
              <div class="section-title">
                <i class="fas fa-pie-chart"></i>
                <h2 id="allocation-heading">Asset Allocation</h2>
              </div>
            </div>
            <div class="allocation-grid">
              <div class="chart-container">
                <canvas
                  id="allocationChart"
                  aria-label="Asset allocation pie chart"
                ></canvas>
              </div>
              <div class="allocation-breakdown">
                <h3 class="breakdown-title">Allocation Breakdown</h3>
                <ul class="allocation-list" id="allocationList">
                  <li class="allocation-item">
                    <div class="allocation-info">
                      <span
                        class="color-indicator"
                        style="background-color: #4f46e5"
                      ></span>
                      <span class="allocation-name">Stocks</span>
                    </div>
                    <div class="allocation-stats">
                      <span class="allocation-percent">45%</span>
                      <span class="allocation-value">$45,000</span>
                    </div>
                  </li>
                  <li class="allocation-item">
                    <div class="allocation-info">
                      <span
                        class="color-indicator"
                        style="background-color: #10b981"
                      ></span>
                      <span class="allocation-name">Bonds</span>
                    </div>
                    <div class="allocation-stats">
                      <span class="allocation-percent">30%</span>
                      <span class="allocation-value">$30,000</span>
                    </div>
                  </li>
                  <li class="allocation-item">
                    <div class="allocation-info">
                      <span
                        class="color-indicator"
                        style="background-color: #f59e0b"
                      ></span>
                      <span class="allocation-name">Mutual Funds</span>
                    </div>
                    <div class="allocation-stats">
                      <span class="allocation-percent">15%</span>
                      <span class="allocation-value">$15,000</span>
                    </div>
                  </li>
                  <li class="allocation-item">
                    <div class="allocation-info">
                      <span
                        class="color-indicator"
                        style="background-color: #8b5cf6"
                      ></span>
                      <span class="allocation-name">SIP</span>
                    </div>
                    <div class="allocation-stats">
                      <span class="allocation-percent">10%</span>
                      <span class="allocation-value">$10,000</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Top Performers & Losers -->
          <section class="section-card" aria-labelledby="performers-heading">
            <div class="section-header">
              <div class="section-title">
                <i class="fas fa-star"></i>
                <h2 id="performers-heading">Top Performers & Losers</h2>
              </div>
            </div>
            <div class="performers-grid">
              <article class="performers-card">
                <h3 class="performers-title">
                  <i class="fas fa-arrow-up text-success"></i> Top Gainers
                </h3>
                <ul class="performers-list" id="topGainers">
                  <li class="performer-item">
                    <div class="performer-info">
                      <span class="performer-symbol">AAPL</span>
                      <span class="performer-name">Apple Inc.</span>
                    </div>
                    <span class="performer-return positive">+24.5%</span>
                  </li>
                  <li class="performer-item">
                    <div class="performer-info">
                      <span class="performer-symbol">NVDA</span>
                      <span class="performer-name">NVIDIA Corp.</span>
                    </div>
                    <span class="performer-return positive">+18.7%</span>
                  </li>
                  <li class="performer-item">
                    <div class="performer-info">
                      <span class="performer-symbol">MSFT</span>
                      <span class="performer-name">Microsoft</span>
                    </div>
                    <span class="performer-return positive">+15.3%</span>
                  </li>
                </ul>
              </article>

              <article class="performers-card">
                <h3 class="performers-title">
                  <i class="fas fa-arrow-down text-danger"></i> Top Losers
                </h3>
                <ul class="performers-list" id="topLosers">
                  <li class="performer-item">
                    <div class="performer-info">
                      <span class="performer-symbol">XYZ</span>
                      <span class="performer-name">XYZ Corp.</span>
                    </div>
                    <span class="performer-return negative">-8.2%</span>
                  </li>
                  <li class="performer-item">
                    <div class="performer-info">
                      <span class="performer-symbol">ABC</span>
                      <span class="performer-name">ABC Ltd.</span>
                    </div>
                    <span class="performer-return negative">-5.4%</span>
                  </li>
                  <li class="performer-item">
                    <div class="performer-info">
                      <span class="performer-symbol">DEF</span>
                      <span class="performer-name">DEF Inc.</span>
                    </div>
                    <span class="performer-return negative">-3.1%</span>
                  </li>
                </ul>
              </article>
            </div>
          </section>
        </div>

        <!-- Footer -->
        <footer id="footer-container"></footer>
      </main>
    </div>

    <!-- Common Modals -->
    <div id="modals-container"></div>

    <!-- Add Benchmark Modal -->
    <dialog
      id="addBenchmarkModal"
      class="modal"
      aria-labelledby="benchmark-modal-title"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="benchmark-modal-title">Add Benchmark</h2>
          <button
            class="modal-close"
            id="closeBenchmarkModal"
            type="button"
            aria-label="Close modal"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="addBenchmarkForm">
            <div class="form-group">
              <label for="benchmarkSymbol">Benchmark Symbol *</label>
              <input
                type="text"
                id="benchmarkSymbol"
                class="input-field"
                placeholder="e.g., ^GSPC, ^IXIC, ^NSEI"
                required
                aria-required="true"
              />
              <small class="form-hint"
                >Use ^ for indices (e.g., ^GSPC for S&P 500)</small
              >
            </div>

            <div class="form-group">
              <label for="benchmarkName">Benchmark Name *</label>
              <input
                type="text"
                id="benchmarkName"
                class="input-field"
                placeholder="e.g., S&P 500, NASDAQ, NIFTY 50"
                required
                aria-required="true"
              />
            </div>

            <div class="form-group">
              <label for="benchmarkType">Index Type *</label>
              <select
                id="benchmarkType"
                class="select-input"
                required
                aria-required="true"
              >
                <option value="">Select index type</option>
                <option value="EQUITY">Equity Index</option>
                <option value="BOND">Bond Index</option>
                <option value="COMMODITY">Commodity Index</option>
                <option value="MIXED">Mixed Index</option>
                <option value="OTHER">Other</option>
              </select>
            </div>

            <div class="form-group">
              <label for="benchmarkDescription">Description (Optional)</label>
              <textarea
                id="benchmarkDescription"
                class="textarea-field"
                rows="3"
                placeholder="Add notes about this benchmark..."
              ></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" id="cancelBenchmarkBtn">
            Cancel
          </button>
          <button type="submit" form="addBenchmarkForm" class="btn-primary">
            <i class="fas fa-plus"></i> Add Benchmark
          </button>
        </div>
      </div>
    </dialog>

    <!-- Loading Overlay -->
    <div id="loading-overlay-container"></div>

    <!-- Toast Notification -->
    <div id="toast" class="toast" role="alert" aria-live="polite"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script type="module" src="../js/main.js"></script>
    <script type="module" src="../js/pages/analytics-page.js"></script>
  </body>
</html>
